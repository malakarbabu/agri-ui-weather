<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>üåæ Paddy Advisor</title>
<style>
  :root{
    --earth:#7a5a2a;
    --leaf:#2e7d32;
    --leaf-2:#4caf50;
    --sun:#f6c144;
    --card:#fff;
    --muted:#556070;
    --glass:rgba(255,255,255,0.85);
    --shadow: 0 6px 18px rgba(15,23,42,0.08);
  }

  /* Layout + Base */
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    background: linear-gradient(135deg,#f6fff2 0%, #fffaf0 100%);
    color:#102027;
    -webkit-font-smoothing:antialiased;
  }
  .wrap{max-width:1100px;margin:18px auto;padding:20px;}

  /* Header */
  header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:18px}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{
    width:56px;height:56px;border-radius:12px;background:linear-gradient(180deg,var(--leaf),var(--leaf-2));
    display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:22px;box-shadow:var(--shadow);
  }
  h1{margin:0;font-size:20px;color:var(--leaf);letter-spacing:0.2px}
  .lang-toggle{display:flex;gap:8px}
  .lang-toggle button{
    background:transparent;border:2px solid rgba(0,0,0,0.06);padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:700;
    transition:transform .18s, background .18s, color .18s;
  }
  .lang-toggle button.active{background:var(--leaf);color:#fff;border-color:var(--leaf)}
  .lang-toggle button:active{transform:scale(.98)}

  /* Grid */
  .grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
    gap:14px;
  }

  /* Card */
  .card{
    background:var(--card);
    border-radius:14px;
    padding:14px;
    box-shadow:var(--shadow);
    transition:transform .2s, box-shadow .2s;
    border:1px solid rgba(16,32,39,0.03);
  }
  .card:hover{transform:translateY(-6px);box-shadow:0 10px 30px rgba(16,32,39,0.08)}
  label{display:flex;align-items:center;gap:8px;font-weight:700;color:var(--earth);margin-bottom:8px}
  .label-icon{width:34px;height:34px;border-radius:8px;background:#fff8ec;display:inline-flex;align-items:center;justify-content:center;font-size:18px;box-shadow:0 2px 8px rgba(0,0,0,0.04);}

  select, input[type="text"], .multiselect{
    width:100%;padding:10px;border-radius:10px;border:1px solid #e6edf0;background:linear-gradient(180deg,#ffffff,#fbfff9);
    font-size:14px;color:#0b1a1a;
  }
  .multiselect{height:110px;overflow:auto;padding:8px}

  /* Actions */
  .actions{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}
  .btn{
    border:none;padding:12px 14px;border-radius:12px;font-weight:800;cursor:pointer;font-size:14px;
    box-shadow:0 6px 18px rgba(16,32,39,0.06);
  }
  .btn.primary{background:linear-gradient(90deg,var(--leaf),var(--leaf-2));color:#fff}
  .btn.ghost{background:transparent;border:1px solid rgba(16,32,39,0.06);color:var(--leaf)}
  .btn.secondary{background:linear-gradient(90deg,var(--sun),#ffd86b);color:#4a2f08}

  /* Results area */
  .results{display:grid;grid-template-columns:2fr 1fr;gap:14px;margin-top:18px}
  @media(max-width:900px){.results{grid-template-columns:1fr}}
  .result-card{background:var(--card);border-radius:14px;padding:16px;box-shadow:var(--shadow)}
  .result-card h3{margin:0 0 10px;color:var(--leaf);font-size:18px}
  .section{margin-bottom:12px;padding:10px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbfff6);border-left:6px solid var(--leaf-2)}
  .section.hi{border-left-color:var(--sun);background:linear-gradient(180deg,#fffdf6,#fff9e6)}
  .section h4{margin:0 0 8px;font-size:15px;color:#204028}
  ul{margin:0;padding-left:18px;color:#123}
  li{margin-bottom:6px}

  .summary{background:linear-gradient(180deg,#fffaf0,#fff8ec);padding:12px;border-radius:10px;border-left:6px solid var(--earth);font-weight:700;color:#3b2a1a}
  .small{color:var(--muted);font-size:13px}
  .notes{font-size:13px;color:var(--muted);margin-top:10px;padding-top:8px;border-top:1px dashed rgba(16,32,39,0.04)}

  /* Tiny helper */
  .muted{color:var(--muted);font-size:13px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">PA</div>
        <div>
          <h1 id="title">üåæ Paddy Advisor</h1>
          <div class="muted" id="subtitle">Interactive farmer guidance (English / ‡¨ì‡¨°‡¨º‡¨ø‡¨Ü)</div>
        </div>
      </div>

      <div class="lang-toggle" role="tablist">
        <button id="btn-en" class="active" aria-pressed="true">English</button>
        <button id="btn-or">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</button>
      </div>
    </header>

    <!-- Selection area -->
    <div class="grid" id="selectors">
      <div class="card">
        <label><span class="label-icon">üå§Ô∏è</span><span id="lblWeather">Weather Condition</span></label>
        <select id="selWeather" aria-label="Weather">
          <!-- populated by JS -->
        </select>
        <div class="small" id="suggWeather"></div>
      </div>

      <div class="card">
        <label><span class="label-icon">üß™</span><span id="lblSoil">Soil pH</span></label>
        <select id="selSoil" aria-label="Soil pH"></select>
        <div class="small" id="suggSoil"></div>
      </div>

      <div class="card">
        <label><span class="label-icon">üåø</span><span id="lblOrganic">Organic Matter</span></label>
        <select id="selOrganic" aria-label="Organic Matter"></select>
        <div class="small" id="suggOrganic"></div>
      </div>

      <div class="card">
        <label><span class="label-icon">‚öóÔ∏è</span><span id="lblNutrient">Nutrient Deficiency</span></label>
        <select id="selNutrient" aria-label="Nutrient"></select>
        <div class="small" id="suggNutrient"></div>
      </div>

      <div class="card">
        <label><span class="label-icon">üåæ</span><span id="lblStage">Stage of Paddy</span></label>
        <select id="selStage" aria-label="Stage"></select>
        <div class="small" id="suggStage"></div>
      </div>

      <div class="card">
        <label><span class="label-icon">üêû</span><span id="lblPests">Observed Pests / Diseases</span></label>
        <!-- multi-select list -->
        <div class="multiselect" id="selPests" role="listbox" aria-multiselectable="true">
          <!-- checkboxes populated in JS -->
        </div>
        <div class="small" id="suggPests">Choose any pests/diseases you see (or none).</div>

        <div class="actions" style="margin-top:12px">
          <button id="btnRecommend" class="btn primary">Show Recommendations</button>
          <button id="btnClear" class="btn ghost">Clear</button>
        </div>
      </div>
    </div>

    <!-- Results -->
    <div class="results" role="region" aria-label="Recommendations area">
      <div class="result-card" id="resultMain">
        <h3 id="resTitle">Recommendations</h3>
        <div id="resContent" class="small">Fill inputs and click <b>Show Recommendations</b>.</div>
      </div>

      <aside class="result-card" id="resultSide" aria-label="Summary">
        <h3 id="sideTitle">Summary</h3>
        <div id="resSummary" class="summary">No selection yet.</div>
        <div class="notes" id="safetyNotes"></div>
      </aside>
    </div>
  </div>

<script>
/* ============================
   BILINGUAL DATA: English + Odia
   ============================ */
const DATA = {
  en: {
    title: "üåæ Paddy Advisor",
    subtitle: "Interactive farmer guidance (English / Odia)",
    labels: {
      weather: "Weather Condition",
      soil: "Soil pH",
      organic: "Organic Matter",
      nutrient: "Nutrient Deficiency",
      stage: "Stage of Paddy",
      pests: "Observed Pests / Diseases"
    },
    options: {
      weather: ["-- Select --","Hot & Dry","Flooded","Raining","Normal","Moderate"],
      soil: ["-- Select --","Acidic (pH < 5.5)","Neutral (pH 5.5‚Äì7.0)","Alkaline (pH > 7.0)"],
      organic: ["-- Select --","Low","Medium","High"],
      nutrient: ["-- Select --","None","Nitrogen","Phosphorus","Potassium","Zinc","Iron"],
      stage: ["-- Select --","Nursery (0‚Äì25 DAS)","Vegetative","Tillering (30‚Äì60 DAS)","Panicle Initiation (60‚Äì100 DAS)","Flowering","Grain Filling (100‚Äì130 DAS)","Maturity (Harvesting)"]
    },
    pestList: ["None","Brown Planthopper (BPH)","Stem Borer","Rice Blast","Bacterial Leaf Blight"],
    tips: {
      weather: {
        "Hot & Dry": "Increase irrigation frequency; mulch to conserve moisture; irrigate mornings/evenings; foliar micronutrient spray if stressed.",
        "Flooded": "Stop irrigation, open drains, watch for root and fungal problems; repair bunds to control flow.",
        "Raining": "Prioritize drainage, reduce standing water, scout for fungal/bacterial diseases after rains.",
        "Normal": "Follow regular irrigation schedule and watch for pests.",
        "Moderate": "Standard care: irrigation, weeding and scouting."
      },
      soil: {
        "Acidic (pH < 5.5)": "Consider lime application; test for Al toxicity; add organic matter.",
        "Neutral (pH 5.5‚Äì7.0)": "Good range ‚Äî maintain organic matter.",
        "Alkaline (pH > 7.0)": "Apply organic matter or sulfur to reduce pH; check Zn availability."
      }
    },
    rec: {
      pests: {
        "Brown Planthopper (BPH)": {
          prevention: ["Avoid excessive N fertilization","Maintain intermittent drainage","Use resistant varieties where available"],
          control: ["Light/pheromone traps","Apply Imidacloprid or Buprofezin (follow label)","Avoid repeated heavy N applications"]
        },
        "Stem Borer": {
          prevention: ["Destroy stubbles and egg masses","Maintain field sanitation"],
          control: ["Pheromone traps","Apply Cartap or other recommended insecticides per label"]
        },
        "Rice Blast": {
          prevention: ["Use resistant varieties","Avoid excessive dense planting","Good drainage"],
          control: ["Spray Tricyclazole at early signs","Fungicide as recommended"]
        },
        "Bacterial Leaf Blight": {
          prevention: ["Use resistant varieties","Avoid excessive nitrogen","Sanitation"],
          control: ["Copper oxychloride sprays as per label","Follow integrated management"]
        }
      },
      irrigationByStage: {
        "Nursery (0‚Äì25 DAS)": "Maintain 2‚Äì3 cm water in nursery beds; do not stress seedlings.",
        "Vegetative": "Maintain shallow water; manage weeds.",
        "Tillering (30‚Äì60 DAS)": "Maintain ~2‚Äì5 cm water; split N application; scout for stem borer/BPH.",
        "Panicle Initiation (60‚Äì100 DAS)": "Keep steady moisture; apply P & K; avoid sudden drought.",
        "Flowering": "Maintain ~5 cm water; avoid spraying systemic insecticides during flowering hours.",
        "Grain Filling (100‚Äì130 DAS)": "Keep soil moist until dough stage; prepare to drain 7‚Äì10 days before harvest.",
        "Maturity (Harvesting)": "Drain field 7‚Äì10 days before harvest; avoid harvesting wet crop."
      },
      fertilizerByStage: {
        "Basal": "Apply 50% N (as basal share), full P (100% recommended), 50% K as basal dose.",
        "Tillering": "Apply 25% N + 25% K at tillering (top-dress).",
        "Panicle": "Apply remaining 25% N + 25% K at panicle initiation."
      },
      nutrientFixes: {
        "Nitrogen": "Top-dress urea in small split doses depending on stage.",
        "Phosphorus": "Apply DAP or SSP at basal application.",
        "Potassium": "Use MOP at basal and topdress as needed.",
        "Zinc": "Soil apply ZnSO4 25 kg/ha or foliar ZnSO4 0.5%.",
        "Iron": "Apply FeSO4 locally and improve water management."
      },
      cultural: [
        "Mulching to retain moisture (esp. Hot & Dry).",
        "Weeding at early stage (use cono-weeder or manual removal).",
        "Maintain bunds and drainage channels.",
        "Use pheromone/light traps for pests."
      ],
      safety: [
        "Do not spray systemic insecticides during flowering hours.",
        "Follow label rates for chemicals and wear PPE.",
        "Avoid excessive nitrogen in wet conditions (increases BPH risk)."
      ],
      dailyRoadmapExample: {
        "Nursery (0‚Äì25 DAS)": ["Day 1‚Äì3: Seed treatment & sowing","Day 4‚Äì15: Maintain 2‚Äì3 cm water; scout for pests","Day 16‚Äì25: Start hardening (reduce water before transplant)"],
        "Tillering (30‚Äì60 DAS)": ["Day 1: Top-dress part of N","Days 2‚Äì10: Weeding","Days 11‚Äì30: Monitor stem borer/BPH; install pheromone traps"]
      }
    }
  },

  or: {
    title: "üåæ ‡¨ß‡¨æ‡¨® ‡¨∏‡¨π‡¨æ‡≠ü‡¨ï",
    subtitle: "‡¨á‡¨£‡≠ç‡¨ü‡¨∞‡¨æ‡¨ï‡≠ç‡¨ü‡¨ø‡¨≠‡≠ç ‡¨´‡¨æ‡¨∞‡≠ç‡¨Æ‡¨∞‡≠ç ‡¨ó‡¨æ‡¨á‡¨°‡≠ç (English / ‡¨ì‡¨°‡¨º‡¨ø‡¨Ü)",
    labels: {
      weather: "‡¨Ü‡¨¨‡¨π‡¨æ (Weather)",
      soil: "‡¨Æ‡¨æ‡¨ü‡¨ø pH",
      organic: "‡¨ú‡≠Ä‡¨¨‡¨æ‡¨£‡≠Å ‡¨™‡¨¶‡¨æ‡¨∞‡≠ç‡¨• (Organic Matter)",
      nutrient: "‡¨™‡≠ã‡¨∑‡¨ï ‡¨Ö‡¨≠‡¨æ‡¨¨",
      stage: "‡¨ß‡¨æ‡¨®‡¨∞ ‡¨Ö‡¨¨‡¨∏‡≠ç‡¨•‡¨æ",
      pests: "‡¨¶‡≠á‡¨ñ‡¨æ‡¨Ø‡¨æ‡¨â‡¨•‡¨ø‡¨¨‡¨æ ‡¨ï‡≠Ä‡¨ü/‡¨∞‡≠ã‡¨ó"
    },
    options: {
      weather: ["-- ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å --","‡¨§‡¨æ‡¨™‡¨Æ‡¨æ‡¨® ‡¨ì ‡¨∂‡≠Å‡¨∑‡≠ç‡¨ï","‡¨¨‡¨®‡≠ç‡≠ü‡¨æ (Flooded)","‡¨¨‡¨∞‡≠ç‡¨∑‡¨æ (Raining)","‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ (Normal)","‡¨Æ‡¨ß‡≠ç‡≠ü‡¨Æ (Moderate)"],
      soil: ["-- ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å --","‡¨Ö‡¨Æ‡≠ç‡¨≥‡≠Ä‡≠ü (pH < 5.5)","‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ (pH 5.5‚Äì7.0)","‡¨ï‡≠ç‡¨∑‡¨æ‡¨∞‡≠Ä‡≠ü (pH > 7.0)"],
      organic: ["-- ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å --","‡¨ï‡¨Æ‡≠ç","‡¨Æ‡¨ß‡≠ç‡≠ü‡¨Æ","‡¨â‡¨ö‡≠ç‡¨ö"],
      nutrient: ["-- ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å --","‡¨ï‡¨ø‡¨õ‡¨ø ‡¨®‡¨æ‡¨π‡¨ø‡¨Å","‡¨®‡¨æ‡¨á‡¨ü‡≠ç‡¨∞‡≠ã‡¨ú‡≠á‡¨®","‡¨´‡¨∏‡¨´‡≠ã‡¨∞‡¨∏‡≠ç","‡¨™‡≠ã‡¨ü‡¨æ‡¨∏‡¨ø‡≠ü‡¨Æ‡≠ç","‡¨ú‡¨ø‡¨ô‡≠ç‡¨ï‡≠ç","‡¨≤‡≠ã‡¨π‡¨æ"],
      stage: ["-- ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å --","‡¨ö‡¨æ‡¨∞‡¨æ (0‚Äì25 ‡¨¶‡¨ø‡¨®)","‡¨¨‡≠É‡¨¶‡≠ç‡¨ß‡¨ø (Vegetative)","‡¨ü‡¨ø‡¨≤‡¨∞‡¨ø‡¨Ç (30‚Äì60 ‡¨¶‡¨ø‡¨®)","‡¨™‡¨æ‡¨®‡¨ø‡¨ï‡¨≤ ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ (60‚Äì100 ‡¨¶‡¨ø‡¨®)","‡¨´‡≠Å‡¨≤‡¨ø‡¨¨‡¨æ (Flowering)","‡¨ß‡¨æ‡¨® ‡¨™‡≠Ç‡¨∞‡¨£ (100‚Äì130 ‡¨¶‡¨ø‡¨®)","‡¨™‡¨ï‡≠ç‡¨ï (Maturity)"]
    },
    pestList: ["‡¨ï‡¨ø‡¨õ‡¨ø ‡¨®‡≠Å‡¨π‡≠á‡¨Å","‡¨¨‡≠ç‡¨∞‡¨æ‡¨â‡¨®‡≠ç ‡¨™‡≠ç‡¨≤‡¨æ‡¨£‡≠ç‡¨ü‡¨π‡¨™‡¨∞‡≠ç (BPH)","‡¨∑‡≠ç‡¨ü‡≠á‡¨Æ‡≠ç ‡¨¨‡≠ã‡¨∞‡¨∞‡≠ç","‡¨ß‡¨æ‡¨® ‡¨¨‡≠ç‡¨≤‡¨æ‡¨∑‡≠ç‡¨ü","‡¨¨‡≠ç‡≠ü‡¨æ‡¨ï‡≠ç‡¨ü‡≠á‡¨∞‡¨ø‡¨Ü‡¨≤‡≠ç ‡¨≤‡¨ø‡¨´‡≠ç ‡¨¨‡≠ç‡¨≤‡¨æ‡¨á‡¨ü‡≠ç"],
    tips:{
      weather:{
        "‡¨§‡¨æ‡¨™‡¨Æ‡¨æ‡¨® ‡¨ì ‡¨∂‡≠Å‡¨∑‡≠ç‡¨ï":"‡¨∏‡¨ø‡¨ö‡¨æ‡¨á ‡¨¨‡¨¢‡¨æ‡¨®‡≠ç‡¨§‡≠Å; ‡¨Æ‡¨≤‡≠ç‡¨ö‡¨ø‡¨Ç ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å; ‡¨∏‡¨ï‡¨æ‡¨≥/‡¨∏‡¨®‡≠ç‡¨ß‡≠ç‡≠ü‡¨æ‡¨∞‡≠á ‡¨∏‡¨ø‡¨ö‡¨æ‡¨á ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å; ‡¨Æ‡¨æ‡¨á‡¨ï‡≠ç‡¨∞‡≠ã‡¨®‡≠ç‡≠ü‡≠Å‡¨ü‡≠ç‡¨∞‡¨ø‡¨è‡¨£‡≠ç‡¨ü ‡¨´‡≠ã‡¨≤‡¨ø‡¨Ü‡¨∞‡≠ç ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨¨‡¨®‡≠ç‡≠ü‡¨æ (Flooded)":"‡¨∏‡¨ø‡¨ö‡¨æ‡¨á ‡¨¨‡¨®‡≠ç‡¨¶ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å; ‡¨°‡≠ç‡¨∞‡≠á‡¨®‡≠ç ‡¨ñ‡≠ã‡¨≤‡¨®‡≠ç‡¨§‡≠Å; ‡¨´‡¨ô‡≠ç‡¨ó‡¨∏‡≠ç ‡¨∞‡≠ã‡¨ó ‡¨™‡¨æ‡¨á‡¨Å ‡¨Ø‡¨æ‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨¨‡¨∞‡≠ç‡¨∑‡¨æ (Raining)":"‡¨°‡≠ç‡¨∞‡≠á‡¨®‡≠á‡¨ú‡≠ç ‡¨¨‡¨¢‡¨º‡¨æ‡¨®‡≠ç‡¨§‡≠Å; ‡¨ó‡≠ã‡¨ü‡¨ø‡¨è ‡¨§‡¨æ‡¨≤‡¨ø‡¨ï‡¨æ ‡¨™‡¨∞‡≠á ‡¨´‡¨ô‡≠ç‡¨ó‡¨∏‡≠ç/‡¨¨‡≠ç‡≠ü‡¨æ‡¨ï‡≠ç‡¨ü‡≠á‡¨∞‡¨ø‡¨Ü ‡¨Ø‡¨æ‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ (Normal)":"‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨™‡¨æ‡¨£‡¨ø ‡¨¨‡≠ç‡≠ü‡¨¨‡¨∏‡≠ç‡¨•‡¨æ ‡¨™‡¨æ‡¨≥‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨Æ‡¨ß‡≠ç‡≠ü‡¨Æ (Moderate)":"‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨ß‡≠ç‡≠ü‡¨æ‡¨®: ‡¨∏‡¨ø‡¨ö‡¨æ‡¨á, ‡¨ú‡¨æ‡¨§‡≠Ä‡≠ü ‡¨ï‡¨æ‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü‡•§"
      },
      soil:{
        "‡¨Ö‡¨Æ‡≠ç‡¨≥‡≠Ä‡≠ü (pH < 5.5)":"‡¨ö‡≠Å‡¨®‡≠ç ‡¨™‡≠ç‡¨∞‡≠ü‡≠ã‡¨ó ‡¨¨‡¨ø‡¨ö‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å; Al ‡¨Ø‡¨æ‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ (pH 5.5‚Äì7.0)":"‡¨ß‡¨æ‡¨® ‡¨™‡¨æ‡¨á‡¨Å ‡¨≠‡¨≤; OM ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨ï‡≠ç‡¨∑‡¨æ‡¨∞‡≠Ä‡≠ü (pH > 7.0)":"‡¨ú‡≠Ä‡¨¨‡¨æ‡¨Æ‡≠É‡¨§ ‡¨ï‡¨ø‡¨Æ‡≠ç‡¨¨‡¨æ ‡¨ó‡¨®‡≠ç‡¨ß‡¨ï ‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å; Zn ‡¨ö‡≠á‡¨ï‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§"
      },
    },
    rec: {
      // translations of rec.* from English to Odia
      pests: {
        "‡¨¨‡≠ç‡¨∞‡¨æ‡¨â‡¨®‡≠ç ‡¨™‡≠ç‡¨≤‡¨æ‡¨£‡≠ç‡¨ü‡¨π‡¨™‡¨∞‡≠ç (BPH)": {
          prevention: ["‡¨Ö‡¨§‡¨ø N ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å ‡¨®‡¨æ‡¨π‡¨ø‡¨Å","‡¨™‡¨æ‡¨£‡¨ø ‡¨Æ‡¨ß‡≠ü‡¨∞‡≠á ‡¨°‡≠ç‡¨∞‡≠á‡¨®‡≠ç ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å","‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨∞‡≠ã‡¨ß‡≠Ä ‡¨™‡≠ç‡¨∞‡¨ú‡¨æ‡¨§‡¨ø ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å"],
          control: ["Light/pheromone traps ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å","Imidacloprid ‡¨ï‡¨ø‡¨Æ‡≠ç‡¨¨‡¨æ Buprofezin (‡¨≤‡≠á‡¨¨‡≠á‡¨≤ ‡¨™‡¨æ‡¨≥‡¨®)","‡¨Ö‡¨§‡¨ø N ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å ‡¨®‡¨æ‡¨π‡¨ø‡¨Å"]
        },
        "‡¨∑‡≠ç‡¨ü‡≠á‡¨Æ‡≠ç ‡¨¨‡≠ã‡¨∞‡¨∞‡≠ç": {
          prevention: ["‡¨∑‡≠ç‡¨ü‡¨¨/‡¨á‡¨®‡≠ç‡¨¶‡≠ç‡¨∞‡≠Å‡¨ó‡¨§/‡¨°‡≠á‡¨¨‡≠ç‡¨∞‡¨ø ‡¨ß‡≠ç‡¨¨‡¨Ç‡¨∏ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å","‡¨´‡¨ø‡¨≤‡≠ç‡¨° ‡¨∏‡¨æ‡¨´‡≠ç ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å"],
          control: ["pheromone traps","Cartap ‡¨™‡≠ç‡¨∞‡≠ü‡≠ã‡¨ó (‡¨≤‡≠á‡¨¨‡≠á‡¨≤ ‡¨Ö‡¨®‡≠Å‡¨∏‡¨∞‡¨£)"]
        },
        "‡¨ß‡¨æ‡¨® ‡¨¨‡≠ç‡¨≤‡¨æ‡¨∑‡≠ç‡¨ü": {
          prevention: ["‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨∞‡≠ã‡¨ß‡≠Ä ‡¨™‡≠ç‡¨∞‡¨ú‡¨æ‡¨§‡¨ø ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞","‡¨ò‡¨® ‡¨≤‡¨ó‡¨æ‡¨£‡¨ø ‡¨®‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å","‡¨≠‡¨≤ ‡¨°‡≠ç‡¨∞‡≠á‡¨®‡≠á‡¨ú‡≠ç"],
          control: ["Tricyclazole ‡¨õ‡¨ø‡¨ü‡¨ï‡¨æ‡¨®‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å","‡¨´‡¨ô‡≠ç‡¨ó‡¨∏‡¨æ‡¨á‡¨°‡≠ç ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å"]
        },
        "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ï‡≠ç‡¨ü‡≠á‡¨∞‡¨ø‡¨Ü‡¨≤‡≠ç ‡¨≤‡¨ø‡¨´‡≠ç ‡¨¨‡≠ç‡¨≤‡¨æ‡¨á‡¨ü‡≠ç": {
          prevention: ["‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨∞‡≠ã‡¨ß‡≠Ä ‡¨™‡≠ç‡¨∞‡¨ú‡¨æ‡¨§‡¨ø ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞","‡¨Ö‡¨§‡¨ø N ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å ‡¨®‡¨æ‡¨π‡¨ø‡¨Å","‡¨∏‡¨Ç‡¨∞‡¨ï‡≠ç‡¨∑‡¨£"],
          control: ["Copper oxychloride ‡¨™‡≠ç‡¨∞‡≠ü‡≠ã‡¨ó","‡¨á‡¨£‡≠ç‡¨ü‡¨ø‡¨ó‡≠ç‡¨∞‡≠á‡¨ü‡≠á‡¨°‡≠ç ‡¨™‡≠ç‡¨∞‡¨¨‡¨®‡≠ç‡¨ß‡¨®"]
        }
      },
      irrigationByStage: {
        "‡¨ö‡¨æ‡¨∞‡¨æ (0‚Äì25 ‡¨¶‡¨ø‡¨®)":"‡¨ö‡¨æ‡¨∞‡¨æ ‡¨¨‡≠á‡¨°‡¨∞‡≠á 2‚Äì3 ‡¨∏‡≠á.‡¨Æ‡¨ø. ‡¨™‡¨æ‡¨£‡¨ø ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨¨‡≠É‡¨¶‡≠ç‡¨ß‡¨ø (Vegetative)":"‡¨Ü‡¨≤‡≠ã‡¨ï‡¨ø‡¨ï ‡¨™‡¨æ‡¨£‡¨ø; ‡¨®‡¨ø‡¨∞‡¨æ‡¨á ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨ü‡¨ø‡¨≤‡¨∞‡¨ø‡¨Ç (30‚Äì60 ‡¨¶‡¨ø‡¨®)":"~2‚Äì5 ‡¨∏‡≠á.‡¨Æ‡¨ø ‡¨™‡¨æ‡¨£‡¨ø; N ‡¨≠‡¨æ‡¨ó‡≠á ‡¨≠‡¨æ‡¨ó‡≠á ‡•§",
        "‡¨™‡¨æ‡¨®‡¨ø‡¨ï‡¨≤ ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ (60‚Äì100 ‡¨¶‡¨ø‡¨®)":"‡¨®‡¨ø‡¨∞‡¨®‡≠ç‡¨§‡¨∞ ‡¨™‡¨æ‡¨£‡¨ø ‡¨ß‡¨∞‡¨®‡≠ç‡¨§‡≠Å; P & K ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨´‡≠Å‡¨≤‡¨ø‡¨¨‡¨æ (Flowering)":"~5 ‡¨∏‡≠á.‡¨Æ‡¨ø ‡¨™‡¨æ‡¨£‡¨ø ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å; ‡¨´‡≠Å‡¨≤‡¨ø‡¨¨‡¨æ ‡¨∏‡¨Æ‡≠ü‡¨∞‡≠á systemic insecticide ‡¨®‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨ß‡¨æ‡¨® ‡¨™‡≠Ç‡¨∞‡¨£ (100‚Äì130 ‡¨¶‡¨ø‡¨®)":"‡¨Ü‡¨ü‡¨æ ‡¨™‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü‡¨®‡≠ç‡¨§ ‡¨™‡¨æ‡¨£‡¨ø ‡¨ß‡¨∞‡¨®‡≠ç‡¨§‡≠Å; 7‚Äì10 ‡¨¶‡¨ø‡¨® ‡¨™‡≠Ç‡¨∞‡≠ç‡¨¨‡¨∞‡≠Å ‡¨ñ‡¨æ‡¨≤‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨™‡¨ï‡≠ç‡¨ï (Maturity)":"‡¨ï‡¨ü‡¨æ‡¨£ ‡¨™‡≠Ç‡¨∞‡≠ç‡¨¨‡¨∞‡≠Å 7‚Äì10 ‡¨¶‡¨ø‡¨® ‡¨´‡¨ø‡¨≤‡≠ç‡¨° ‡¨ñ‡¨æ‡¨≤‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§"
      },
      fertilizerByStage: {
        "Basal":"50% N, 100% P, 50% K (‡¨Æ‡≠Ç‡¨≥ ‡¨ñ‡≠Å‡¨£‡≠ç‡¨°‡¨∞‡≠á)‡•§",
        "Tillering":"25% N + 25% K (‡¨ü‡¨ø‡¨≤‡¨∞‡¨ø‡¨Ç‡¨∞‡≠á)‡•§",
        "Panicle":"‡¨∂‡≠á‡¨∑ 25% N + 25% K (‡¨™‡¨æ‡¨®‡¨ø‡¨ï‡¨≤‡¨∞‡≠á)‡•§"
      },
      nutrientFixes: {
        "‡¨®‡¨æ‡¨á‡¨ü‡≠ç‡¨∞‡≠ã‡¨ú‡≠á‡¨®":"‡¨≠‡¨æ‡¨ó‡≠á ‡¨≠‡¨æ‡¨ó‡≠á urea ‡¨ü‡¨™‡≠ç ‡¨°‡≠ç‡¨∞‡≠á‡¨∏‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨´‡¨∏‡¨´‡≠ã‡¨∞‡¨∏‡≠ç":"DAP/SSP ‡¨¨‡≠á‡¨∏‡¨æ‡¨≤‡¨∞‡≠á ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨™‡≠ã‡¨ü‡¨æ‡¨∏‡¨ø‡≠ü‡¨Æ‡≠ç":"MOP ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨ú‡¨ø‡¨ô‡≠ç‡¨ï‡≠ç":"ZnSO4 25 kg/ha ‡¨ï‡¨ø‡¨Æ‡≠ç‡¨¨‡¨æ 0.5% foliar spray‡•§",
        "‡¨≤‡≠ã‡¨π‡¨æ":"FeSO4 ‡¨Ü‡¨¨‡¨∂‡≠ç‡≠ü‡¨ï ‡¨Ö‡¨®‡≠Å‡¨∏‡¨æ‡¨∞‡≠á‡•§"
      },
      cultural: [
        "‡¨Æ‡¨≤‡≠ç‡¨ö‡¨ø‡¨Ç (‡¨∂‡≠Å‡¨∑‡≠ç‡¨ï ‡¨¶‡¨ø‡¨®‡¨∞‡≠á ‡¨∞‡¨ï‡≠ç‡¨∑‡¨æ)‡•§",
        "‡¨Ö‡¨∞‡¨Æ‡≠ç‡¨≠‡¨ø‡¨ï ‡¨ï‡¨ø‡¨ü‡¨æ‡¨¨‡¨æ‡¨ü‡¨ø: N ‡¨®‡¨ø‡≠ü‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£‡•§",
        "‡¨¨‡¨®‡≠ç‡¨ß/‡¨°‡≠ç‡¨∞‡≠á‡¨®‡≠ç ‡¨†‡¨ø‡¨ï‡≠ç ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "pheromone/light traps ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§"
      ],
      safety: [
        "‡¨´‡≠Å‡¨≤‡¨ø‡¨¨‡¨æ ‡¨∏‡¨Æ‡≠ü‡¨∞‡≠á systemic insecticide ‡¨õ‡¨ø‡¨ü‡¨ï‡¨æ‡¨®‡¨æ ‡¨®‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨∞‡¨æ‡¨∏‡¨æ‡≠ü‡¨® ‡¨™‡≠ç‡¨∞‡≠ü‡≠ã‡¨ó ‡¨™‡¨æ‡¨á‡¨Å PPE ‡¨™‡¨ø‡¨®‡≠ç‡¨ß‡¨®‡≠ç‡¨§‡≠Å‡•§",
        "‡¨≠‡¨∞‡≠ç‡¨∑‡¨æ ‡¨∏‡¨Æ‡≠ü‡¨∞‡≠á ‡¨Ö‡¨§‡¨ø ‡¨® ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å ‚Äî BPH ‡¨¨‡¨¢‡¨º‡¨ø‡¨™‡¨æ‡¨∞‡≠á‡•§"
      ],
      dailyRoadmapExample: {
        "‡¨ö‡¨æ‡¨∞‡¨æ (0‚Äì25 ‡¨¶‡¨ø‡¨®)":["‡¨¶‡¨ø‡¨® 1‚Äì3: ‡¨¨‡≠Ä‡¨ú ‡¨ö‡¨ø‡¨ï‡¨ø‡¨§‡≠ç‡¨∏‡¨æ ‡¨ì ‡¨∏‡≠á‡¨°‡¨ø‡¨Ç","‡¨¶‡¨ø‡¨® 4‚Äì15: 2‚Äì3 ‡¨∏‡≠á.‡¨Æ‡¨ø. ‡¨™‡¨æ‡¨£‡¨ø ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å; ‡¨ñ‡≠ã‡¨ú ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å","‡¨¶‡¨ø‡¨® 16‚Äì25: ‡¨π‡¨æ‡¨∞‡≠ç‡¨°‡≠á‡¨®‡¨ø‡¨Ç (‡¨™‡≠ã‡¨§‡¨® ‡¨™‡≠Ç‡¨∞‡≠ç‡¨¨‡¨∞‡≠Å)"]
      }
    }
  }
};

/* ====================
   UI Wiring + Behavior
   ==================== */
let LANG='en'; // default

// Elements map
const E = {
  title: document.getElementById('title'),
  subtitle: document.getElementById('subtitle'),
  btnEn: document.getElementById('btn-en'),
  btnOr: document.getElementById('btn-or'),
  selWeather: document.getElementById('selWeather'),
  selSoil: document.getElementById('selSoil'),
  selOrganic: document.getElementById('selOrganic'),
  selNutrient: document.getElementById('selNutrient'),
  selStage: document.getElementById('selStage'),
  selPests: document.getElementById('selPests'),
  suggWeather: document.getElementById('suggWeather'),
  suggSoil: document.getElementById('suggSoil'),
  suggOrganic: document.getElementById('suggOrganic'),
  suggNutrient: document.getElementById('suggNutrient'),
  suggStage: document.getElementById('suggStage'),
  suggPests: document.getElementById('suggPests'),
  btnRecommend: document.getElementById('btnRecommend'),
  btnClear: document.getElementById('btnClear'),
  resContent: document.getElementById('resContent'),
  resSummary: document.getElementById('resSummary'),
  safetyNotes: document.getElementById('safetyNotes'),
  resTitle: document.getElementById('resTitle'),
  sideTitle: document.getElementById('sideTitle')
};

// Populate dropdowns / pest list
function populate(){
  const D = DATA[LANG];
  E.title.textContent = D.title;
  E.subtitle.textContent = D.subtitle;
  document.getElementById('lblWeather').textContent = D.labels.weather;
  document.getElementById('lblSoil').textContent = D.labels.soil;
  document.getElementById('lblOrganic').textContent = D.labels.organic;
  document.getElementById('lblNutrient').textContent = D.labels.nutrient;
  document.getElementById('lblStage').textContent = D.labels.stage;
  document.getElementById('lblPests').textContent = D.labels.pests;
  E.resTitle.textContent = LANG==='en' ? "Recommendations" : "‡¨™‡¨∞‡¨æ‡¨Æ‡¨∞‡≠ç‡¨∂";
  E.sideTitle.textContent = LANG==='en' ? "Summary" : "‡¨∏‡¨æ‡¨∞‡¨æ‡¨Ç‡¨∂";

  // helpers
  function fillSelect(sel, arr){
    sel.innerHTML = "";
    arr.forEach(v=>{
      const opt = document.createElement('option'); opt.value=v; opt.textContent=v; sel.appendChild(opt);
    });
  }
  fillSelect(E.selWeather, D.options.weather);
  fillSelect(E.selSoil, D.options.soil);
  fillSelect(E.selOrganic, D.options.organic);
  fillSelect(E.selNutrient, D.options.nutrient);
  fillSelect(E.selStage, D.options.stage);

  // pests checkboxes
  E.selPests.innerHTML = "";
  D.pestList.forEach((p, i)=>{
    const id = `pest-${i}`;
    const row = document.createElement('div');
    row.style.display='flex'; row.style.alignItems='center'; row.style.gap='8px'; row.style.padding='6px 4px';
    const cb = document.createElement('input'); cb.type='checkbox'; cb.id=id; cb.value=p;
    const label = document.createElement('label'); label.htmlFor=id; label.style.userSelect='none';
    label.textContent = p;
    row.appendChild(cb); row.appendChild(label);
    E.selPests.appendChild(row);
  });

  // clear results
  E.resContent.innerHTML = LANG==='en' ? 'Fill inputs and click <b>Show Recommendations</b>.' : '‡¨¨‡¨ø‡¨ï‡¨≥‡≠ç‡¨™ ‡¨≠‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨è‡¨¨‡¨Ç "Show Recommendations" ‡¨¶‡¨¨‡¨æ‡¨®‡≠ç‡¨§‡≠Å ‡•§';
  E.resSummary.textContent = LANG==='en' ? 'No selection yet.' : '‡¨ï‡≠å‡¨£‡¨∏‡¨ø ‡¨™‡¨∏‡¨®‡≠ç‡¨¶ ‡¨®‡¨æ‡¨π‡¨ø‡¨Å‡•§';
  E.safetyNotes.innerHTML = "";
}
populate();

/* Language toggles */
E.btnEn.addEventListener('click', ()=>{ LANG='en'; E.btnEn.classList.add('active'); E.btnOr.classList.remove('active'); populate();});
E.btnOr.addEventListener('click', ()=>{ LANG='or'; E.btnOr.classList.add('active'); E.btnEn.classList.remove('active'); populate();});

/* Utility: get selected pests (array of strings, excluding 'None') */
function getSelectedPests(){
  const checks = Array.from(E.selPests.querySelectorAll('input[type=checkbox]'));
  return checks.filter(c=>c.checked).map(c=>c.value).filter(v=>v && !v.toLowerCase().includes('none'));
}

/* Show Recommendations */
E.btnRecommend.addEventListener('click', ()=>{
  const d = DATA[LANG];
  const weather = E.selWeather.value;
  const soil = E.selSoil.value;
  const organic = E.selOrganic.value;
  const nutrient = E.selNutrient.value;
  const stage = E.selStage.value;
  const pests = getSelectedPests();

  // basic validation
  if(!weather || weather.startsWith('--') || !soil || soil.startsWith('--') || !stage || stage.startsWith('--')){
    E.resContent.innerHTML = LANG==='en' ? "<b>Please select Weather, Soil and Stage before getting recommendations.</b>" : "<b>‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨Ü‡¨¨‡¨π‡¨æ, ‡¨Æ‡¨æ‡¨ü‡¨ø ‡¨ì ‡¨Ö‡¨¨‡¨∏‡≠ç‡¨•‡¨æ ‡¨ö‡≠ü‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§</b>";
    return;
  }

  // Build results HTML
  let html = "";

  // 1. Pest Controls (if any selected show their controls; otherwise show likely pests by stage)
  html += `<div class="section"><h4>üêû ${LANG==='en' ? 'Pest & Disease Controls' : '‡¨ï‡≠Ä‡¨ü/‡¨∞‡≠ã‡¨ó ‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨∞‡≠ã‡¨ß ‡¨ì ‡¨®‡¨ø‡≠ü‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£'}</h4>`;
  if(pests.length){
    // explicit pests chosen: show prevention + control
    pests.forEach(p => {
      const key = Object.keys(d.rec.pests).find(k => k.toLowerCase().includes(p.split(' ')[0].toLowerCase()) || k === p) || p;
      const rec = d.rec.pests[key] || d.rec.pests[p] || null;
      if(rec){
        html += `<div style="margin-bottom:8px"><b>${p}:</b><ul>`;
        html += `<li><i>Prevention:</i> ${Array.isArray(rec.prevention) ? rec.prevention.join('; ') : (rec.prevention || '')}</li>`;
        html += `<li><i>Control:</i> ${Array.isArray(rec.control) ? rec.control.join('; ') : (rec.control || '')}</li>`;
        html += `</ul></div>`;
      } else {
        html += `<div><b>${p}:</b> ${LANG==='en' ? 'Observe & scout; apply integrated measures.' : '‡¨®‡¨ø‡¨∞‡≠Ä‡¨ï‡≠ç‡¨∑‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å; ‡¨∏‡¨Æ‡¨®‡≠ç‡≠±‡¨ø‡¨§ ‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡¨®‡¨ø‡¨Ü‡¨Å‡•§'}</div>`;
      }
    });
  } else {
    // no pests selected -> show likely pests for stage
    html += `<div class="small"><b>${LANG==='en' ? 'Likely pests/diseases for this stage:' : '‡¨è‡¨π‡¨ø ‡¨Ö‡¨¨‡¨∏‡≠ç‡¨•‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨∏‡¨Æ‡≠ç‡¨≠‡¨æ‡¨¨‡≠ç‡≠ü ‡¨ï‡≠Ä‡¨ü/‡¨∞‡≠ã‡¨ó:'}</b></div><ul>`;
    const stageKey = stage;
    // check English first, if not found try Odia mapping (DATA structure has pestsByStage in english earlier; we use rec.pests keys approximation)
    // We'll attempt to map by stage to guidance: keep simple and high-value
    const likely = [];
    const enRec = DATA.en.recommendations ? DATA.en.recommendations.pestsByStage : null;
    if(enRec && enRec[stageKey]) {
      enRec[stageKey].forEach(p => likely.push(p));
    } else {
      // fallback: common pests
      likely.push('Stem Borer','Brown Planthopper (BPH)');
    }
    likely.forEach(p => html += `<li>${p} ‚Äî ${ (DATA.en.recommendations && DATA.en.recommendations.pestControls && DATA.en.recommendations.pestControls[p]) ? DATA.en.recommendations.pestControls[p].join('; ') : (LANG==='en'?'Monitor & use IPM':'‡¨®‡¨ø‡¨∞‡≠Ä‡¨ï‡≠ç‡¨∑‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å') }</li>`);
    html += `</ul>`;
  }
  html += `</div>`;

  // 2. Irrigation advice (combine stage & weather)
  html += `<div class="section hi"><h4>üíß ${LANG==='en' ? 'Irrigation Strategy' : '‡¨∏‡¨ø‡¨ö‡¨æ‡¨á ‡¨¨‡≠ç‡≠ü‡≠Å‡¨∏‡≠ç‡¨•‡¨æ'}</h4>`;
  const irrStage = d.rec.irrigationByStage[stage] || (LANG==='en' ? 'Standard irrigation for stage.' : '‡¨Ö‡¨¨‡¨∏‡≠ç‡¨•‡¨æ‡¨®‡≠Å‡¨∏‡¨æ‡¨∞‡≠Ä ‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨∏‡¨ø‡¨ö‡¨æ‡¨á‡•§');
  let irrNote = irrStage;
  // Adjust for weather specifics
  if(weather.toLowerCase().includes('hot') || weather.toLowerCase().includes('‡¨∂‡≠Å‡¨∑‡≠ç‡¨ï') ) {
    irrNote += LANG==='en' ? " Increase frequency; prefer early morning/evening water; use mulching." : " ‡¨ù‡¨æ‡¨≤‡¨ø‡¨¨‡¨æ ‡¨¨‡≠á‡¨≥‡≠á ‡¨™‡¨æ‡¨£‡¨ø ‡¨¨‡¨¢‡¨æ‡¨®‡≠ç‡¨§‡≠Å; ‡¨Æ‡¨≤‡≠ç‡¨ö‡¨ø‡¨Ç ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§";
  }
  if(weather.toLowerCase().includes('flood') || weather.toLowerCase().includes('‡¨¨‡¨®‡≠ç‡≠ü‡¨æ')) {
    irrNote += LANG==='en' ? " Drain & prioritize removing standing water." : " ‡¨°‡≠ç‡¨∞‡≠á‡¨®‡≠ç ‡¨¨‡¨π‡≠Å‡¨§ ‡¨Ü‡¨¨‡¨∂‡≠ç‡≠ü‡¨ï‡•§";
  }
  if(weather.toLowerCase().includes('rain') || weather.toLowerCase().includes('‡¨¨‡¨∞‡≠ç‡¨∑‡¨æ')) {
    irrNote += LANG==='en' ? " Reduce irrigation; improve drainage after heavy rains." : " ‡¨¨‡¨∞‡≠ç‡¨∑‡¨æ ‡¨∞‡≠Å ‡¨∂‡≠á‡¨∑ ‡¨™‡¨∞‡≠á ‡¨°‡≠ç‡¨∞‡≠á‡¨®‡≠á‡¨ú‡≠ç ‡¨¨‡¨¢‡¨æ‡¨®‡≠ç‡¨§‡≠Å‡•§";
  }

  html += `<div class="small">${irrNote}</div></div>`;

  // 3. Fertilizer advice (general schedule + nutrient-specific)
  html += `<div class="section"><h4>üß™ ${LANG==='en' ? 'Fertilizer Advice' : '‡¨â‡¨∞‡≠ç‡¨¨‡¨∞‡¨ï ‡¨∏‡≠Å‡¨™‡¨æ‡¨∞‡¨ø‡¨∂'}</h4>`;
  html += `<div class="small"><b>${LANG==='en' ? 'General split schedule:' : '‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨¨‡¨æ‡¨£‡≠ç‡¨ü‡¨ø‡¨§ ‡¨Ö‡¨≠‡¨ø‡¨®‡≠ç‡≠ü‡¨æ‡¨∏:'}</b></div><ul>`;
  html += `<li><b>${LANG==='en' ? 'Basal' : '‡¨Æ‡≠Ç‡¨≥'}</b>: ${d.rec.fertilizerByStage.Basal || ''}</li>`;
  html += `<li><b>${LANG==='en' ? 'Tillering' : '‡¨ü‡¨ø‡¨≤‡¨∞‡¨ø‡¨Ç'}</b>: ${d.rec.fertilizerByStage.Tillering || ''}</li>`;
  html += `<li><b>${LANG==='en' ? 'Panicle' : '‡¨™‡¨æ‡¨®‡¨ø‡¨ï‡¨≤'}</b>: ${d.rec.fertilizerByStage.Panicle || ''}</li>`;
  html += `</ul>`;

  if(nutrient && !nutrient.startsWith('--') && nutrient !== (LANG==='en' ? 'None' : '‡¨ï‡¨ø‡¨õ‡¨ø ‡¨®‡¨æ‡¨π‡¨ø‡¨Å')){
    const fix = (LANG==='en' ? d.rec.nutrientFixes[nutrient] : d.rec.nutrientFixes[nutrient] || d.rec.nutrientFixes[ translateNutrientToEn(nutrient) ]);
    // For Odia nutrient mapping we provided values in or.rec.nutrientFixes as well
    let fixText = fix || ( (LANG==='or') ? DATA.or.rec.nutrientFixes[nutrient] : null );
    if(!fixText && LANG==='en'){
      fixText = d.rec.nutrientFixes[nutrient] || "Apply recommended nutrient form per soil test.";
    }
    html += `<div class="small"><b>${LANG==='en' ? 'Adjustment for deficiency:' : '‡¨Ö‡¨≠‡¨æ‡¨¨ ‡¨™‡¨æ‡¨á‡¨Å ‡¨∏‡¨Æ‡¨®‡≠ç‡≠±‡≠ü:'}</b> ${fixText}</div>`;
  }
  html += `</div>`;

  // 4. Cultural practices
  html += `<div class="section"><h4>üå± ${LANG==='en' ? 'Cultural Practices' : '‡¨∏‡¨æ‡¨Ç‡¨∏‡≠ç‡¨ï‡≠É‡¨§‡¨ø‡¨ï ‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™'}</h4><ul>`;
  d.rec.cultural.forEach(c => html += `<li>${c}</li>`);
  html += `</ul></div>`;

  // 5. Daily Roadmap (if available)
  html += `<div class="section"><h4>üìÖ ${LANG==='en' ? 'Daily Roadmap & Tasks' : '‡¨¶‡≠à‡¨®‡¨ø‡¨ï ‡¨ï‡¨æ‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü'}</h4>`;
  const roadmap = (d.rec.dailyRoadmapExample && d.rec.dailyRoadmapExample[stage]) || (LANG==='or' && DATA.or.rec.dailyRoadmapExample && DATA.or.rec.dailyRoadmapExample[stage]);
  if(roadmap){
    html += `<ul>`;
    roadmap.forEach(i => html += `<li>${i}</li>`);
    html += `</ul>`;
  } else {
    html += `<div class="small">${LANG==='en' ? 'Follow stage tasks: irrigation, weeding, scouting, split fertilization.' : '‡¨Ö‡¨¨‡¨∏‡≠ç‡¨•‡¨æ‡¨®‡≠Å‡¨∏‡¨æ‡¨∞‡≠Ä ‡¨ï‡¨æ‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü: ‡¨∏‡¨ø‡¨ö‡¨æ‡¨á, ‡¨®‡¨ø‡¨∞‡¨æ‡¨á, ‡¨™‡¨∞‡≠Ä‡¨ï‡≠ç‡¨∑‡¨æ, ‡¨≠‡¨æ‡¨ó‡≠á ‡¨≠‡¨æ‡¨ó‡≠á ‡¨â‡¨∞‡≠ç‡¨¨‡¨∞‡¨ï‡•§'}</div>`;
  }
  html += `</div>`;

  // 6. Safety notes
  html += `<div class="section hi"><h4>‚ö†Ô∏è ${LANG==='en' ? 'Safety & Notes' : '‡¨∏‡≠Å‡¨∞‡¨ï‡≠ç‡¨∑‡¨æ ‡¨ì ‡¨ü‡¨ø‡¨™‡≠ç‡¨∏'}</h4><ul>`;
  (d.rec.safety || []).forEach(s => html += `<li>${s}</li>`);
  html += `</ul></div>`;

  E.resContent.innerHTML = html;

  // Summary & safety notes side
  const parts = [];
  parts.push(`${LANG==='en' ? 'Weather' : '‡¨Ü‡¨¨‡¨π‡¨æ'}: ${weather}`);
  parts.push(`${LANG==='en' ? 'Stage' : '‡¨Ö‡¨¨‡¨∏‡≠ç‡¨•‡¨æ'}: ${stage}`);
  parts.push(`${LANG==='en' ? 'Soil' : '‡¨Æ‡¨æ‡¨ü‡¨ø'}: ${soil}`);
  if(nutrient && !nutrient.startsWith('--')) parts.push(`${LANG==='en' ? 'Deficiency' : '‡¨Ö‡¨≠‡¨æ‡¨¨'}: ${nutrient}`);
  if(pests.length) parts.push(`${LANG==='en' ? 'Pests' : '‡¨ï‡≠Ä‡¨ü'}: ${pests.join(', ')}`);

  E.resSummary.innerHTML = parts.join(' ‚Ä¢ ');
  E.safetyNotes.innerHTML = `<strong>${LANG==='en' ? 'Safety:' : '‡¨∏‡≠Å‡¨∞‡¨ï‡≠ç‡¨∑‡¨æ:'}</strong> ${(d.rec.safety || []).join(' ‚Ä¢ ')}`;
});

/* Clear button */
E.btnClear.addEventListener('click', ()=>{
  // reset selects and checkboxes
  ['selWeather','selSoil','selOrganic','selNutrient','selStage'].forEach(id=>document.getElementById(id).selectedIndex = 0);
  Array.from(E.selPests.querySelectorAll('input[type=checkbox]')).forEach(cb=>cb.checked=false);
  E.resContent.innerHTML = LANG==='en' ? 'Fill inputs and click <b>Show Recommendations</b>.' : '‡¨¨‡¨ø‡¨ï‡¨≥‡≠ç‡¨™ ‡¨≠‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨è‡¨¨‡¨Ç "Show Recommendations" ‡¨¶‡¨¨‡¨æ‡¨®‡≠ç‡¨§‡≠Å ‡•§';
  E.resSummary.textContent = LANG==='en' ? 'No selection yet.' : '‡¨ï‡≠å‡¨£‡¨∏‡¨ø ‡¨™‡¨∏‡¨®‡≠ç‡¨¶ ‡¨®‡¨æ‡¨π‡¨ø‡¨Å‡•§';
  E.safetyNotes.innerHTML = "";
});

/* small helper to map Odia nutrient names to English key if needed */
function translateNutrientToEn(n){
  if(!n) return n;
  const map = {
    '‡¨®‡¨æ‡¨á‡¨ü‡≠ç‡¨∞‡≠ã‡¨ú‡≠á‡¨®':'Nitrogen','‡¨´‡¨∏‡¨´‡≠ã‡¨∞‡¨∏‡≠ç':'Phosphorus','‡¨™‡≠ã‡¨ü‡¨æ‡¨∏‡¨ø‡≠ü‡¨Æ‡≠ç':'Potassium',
    '‡¨ú‡¨ø‡¨ô‡≠ç‡¨ï‡≠ç':'Zinc','‡¨≤‡≠ã‡¨π‡¨æ':'Iron'
  };
  return map[n] || n;
}
</script>
</body>
</html>
